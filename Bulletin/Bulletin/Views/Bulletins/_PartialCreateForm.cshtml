@using Bulletin.Repositories;
@using Bulletin.Models;
@using Bulletin.Common;


<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Административные районы</th>
            <th></th>
            <th>Облачность</th>
            <th>Осадки</th>
            <th>Явления</th>
            <th>Ветер</th>            
            <th>Температура</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var territory in ((IRepository<Territory>)(new TerritoryRepository())).GetAll())
        {
            <tr>
                <td rowspan="2">@territory.Name</td>
                <td>
                        
                        <label for="mySubmit" class="btn btn-default"><i class="glyphicon glyphicon-copy"></i> </label>
    <input id="mySubmit" type="text" value="Go" class="hidden" />



                      <a href="#" class="btn btn-default">
                        <span class="glyphicon glyphicon-paste"></span>
                      </a>
                </td>
                <td id="TdCloudinessNight@(territory.ID)" class="cursorClick" onclick="handleCloudinessNight(@(territory.ID))"></td>
                <td id="TdPrecipitationNight@(territory.ID)" class="cursorClick" onclick="handlePrecipitationNight(@(territory.ID))"></td>
                <td class="cursorClick" onclick="handleConditionNight(@(territory.ID))"></td>
                <td class="cursorClick" onclick="handleWindNight(@(territory.ID))"></td>
                <td class="cursorClick" onclick="handleTemperatureNight(@(territory.ID))"></td>
            </tr>
            <tr>
                <td>
                        
                      <a href="#" class="btn btn-default">
                        <span class="glyphicon glyphicon-copy"></span>
                      </a>

                      <a href="#" class="btn btn-default">
                        <span class="glyphicon glyphicon-paste"></span>
                      </a>
                </td>
                <td id="TdCloudinessDay@(territory.ID)" class="cursorClick" onclick="handleCloudinessDay(@(territory.ID))"></td>
                <td id="TdPrecipitationDay@(territory.ID)" class="cursorClick" onclick="handlePrecipitationDay(@(territory.ID))"></td>
                <td class="cursorClick" onclick="handleConditionDay(@(territory.ID))"></td>
                <td class="cursorClick" onclick="handleWindDay(@(territory.ID))"></td>
                <td class="cursorClick" onclick="handleTemperatureDay(@(territory.ID))"></td>
            </tr>
        }
    </tbody>
</table>



<script>
    function handleCloudinessNight(id) {
        $("#TerritoryID-Modal").val(id);
        $("#TerritoryID-Modal-Night").val(1);
        

        $("#cloudiness-panel").attr("class", "panel panel-primary");
        $("#cloudiness-panel-heading").text("Укажите облачность ночью");
        $("#ModalCloudiness").modal('show');
    }

    function handleCloudinessDay(id) {
        
        $("#TerritoryID-Modal").val(id);
        $("#TerritoryID-Modal-Night").val(0);

        $("#cloudiness-panel").attr("class", "panel panel-success");
        $("#cloudiness-panel-heading").text("Укажите облачность днём");
        $("#ModalCloudiness").modal('show');
    }

    function handlePrecipitationNight(id) {

        $("#TerritoryID-Precipitation-Modal").val(id);
        $("#TerritoryID-Precipitation-Modal-Night").val(1);

        $("#precipitation-panel").attr("class", "panel panel-primary");
        $("#precipitation-panel-heading").text("Ночью");
        $("#ModalPrecipitation").modal('show');
    }

    function handlePrecipitationDay(id) {
        
        $("#TerritoryID-Precipitation-Modal").val(id);
        $("#TerritoryID-Precipitation-Modal-Night").val(0);

        $("#precipitation-panel").attr("class", "panel panel-success");
        $("#precipitation-panel-heading").text("Днём");
        $("#ModalPrecipitation").modal('show');
    }
    
    function handleConditionNight(id) {
        $("#TerritoryID").text(id);
        $("#condition-panel").attr("class", "panel panel-primary");
        $("#condition-panel-heading").text("Ночью");
        $("#ModalCondition").modal('show');
    }

    function handleConditionDay(id) {
        $("#TerritoryID").text(id);
        $("#condition-panel").attr("class", "panel panel-success");
        $("#condition-panel-heading").text("Днём");
        $("#ModalCondition").modal('show');
    }

    function handleWindNight(id) {
        $("#TerritoryID").text(id);
        $("#wind-panel").attr("class", "panel panel-primary");
        $("#wind-panel-heading").text("Ночью");
        $("#ModalWind").modal('show');
    }

    function handleWindDay(id) {
        $("#TerritoryID").text(id);
        $("#wind-panel").attr("class", "panel panel-success");
        $("#wind-panel-heading").text("Днём");
        $("#ModalWind").modal('show');
    }
    
    function handleTemperatureNight(id) {
        $("#TerritoryID").text(id);
        $("#temperature-panel").attr("class", "panel panel-primary");
        $("#temperature-panel-heading").text("Ночью");
        $("#ModalTemperature").modal('show');
    }

    function handleTemperatureDay(id) {
        $("#TerritoryID").text(id);
        $("#temperature-panel").attr("class", "panel panel-success");
        $("#temperature-panel-heading").text("Днём");
        $("#ModalTemperature").modal('show');
    }
</script>

<script>
    function handleSaveCloudiness() {

        if ($("#TerritoryID-Modal-Night").val() == "1") {            
            $("#TdCloudinessNight" + $("#TerritoryID-Modal").val()).text($("#bulletin-@(ViewBag.forecast)-cloudiness-night").val());
        }
        else {
            $("#TdCloudinessDay" + $("#TerritoryID-Modal").val()).text($("#bulletin-@(ViewBag.forecast)-cloudiness-night").val());
        }
    }

    function handleSavePrecipitation() {
        
        if ($("#TerritoryID-Precipitation-Modal-Night").val() == "1") {
            $("#TdPrecipitationNight" + $("#TerritoryID-Precipitation-Modal").val()).text($("#bulletin-@(ViewBag.forecast)-precipitation-night").val());
        }
        else {
            $("#TdPrecipitationDay" + $("#TerritoryID-Precipitation-Modal").val()).text($("#bulletin-@(ViewBag.forecast)-precipitation-night").val());
        }
    }
</script>




    <div id="ModalCloudiness" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Облачность</h4>
                </div>
                <div class="modal-body">
                    
                    @Html.Hidden("TerritoryID-Modal", "0")
                    @Html.Hidden("TerritoryID-Modal-Night", "0")
                    @Html.Partial("Params\\_Cloudiness", new ViewDataDictionary { { "forecast", ViewBag.forecast } })    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="handleSaveCloudiness()"  data-dismiss="modal">Сохранить</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
                </div>
            </div>
        </div>
    </div>
    

    <div id="ModalPrecipitation" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Укажите осадки</h4>
                </div>
                <div class="modal-body">
                    <div id="TerritoryID">
                    </div>
                    
                    @Html.Hidden("TerritoryID-Precipitation-Modal", "0")
                    @Html.Hidden("TerritoryID-Precipitation-Modal-Night", "0")
                    @Html.Partial("Params\\_Precipitation", new ViewDataDictionary { { "forecast", ViewBag.forecast } })    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" onclick="handleSavePrecipitation()" data-dismiss="modal">Сохранить</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Отмена</button>
                </div>
            </div>
        </div>
    </div>

    
    <div id="ModalCondition" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Укажите явления</h4>
                </div>
                <div class="modal-body">
                    
                    @Html.Partial("Params\\_Condition", new ViewDataDictionary { { "forecast", ViewBag.forecast } })    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary">Сохранить</button>
                </div>
            </div>
        </div>
    </div>

    
    <div id="ModalWind" class="modal modal-wide fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Укажите ветер</h4>
                </div>
                <div class="modal-body">
                    
                    @Html.Partial("Params\\_Wind", new ViewDataDictionary { { "forecast", ViewBag.forecast } })    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary">Сохранить</button>
                </div>
            </div>
        </div>
    </div>

    
    <div id="ModalTemperature" class="modal modal-wide fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Укажите температуру</h4>
                </div>
                <div class="modal-body">
                    
                    @Html.Partial("Params\\_Temperature", new ViewDataDictionary { { "forecast", ViewBag.forecast } })    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
                    <button type="button" class="btn btn-primary">Сохранить</button>
                </div>
            </div>
        </div>
    </div>


    <script>
        $(".modal-wide").on("show.bs.modal", function () {
            var height = $(window).height() - 200;
            $(this).find(".modal-body").css("max-height", height);
        });
   </script>